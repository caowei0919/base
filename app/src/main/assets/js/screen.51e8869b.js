(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"123a":function(t,e,a){},1573:function(t,e,a){"use strict";(function(t){a("99af"),a("7db0"),a("4160"),a("caad"),a("a15b"),a("ac1f"),a("2532"),a("1276"),a("2ca0"),a("159b"),a("cca6");var i=a("2909"),n=a("b85c"),o=a("5530"),s=a("0aad"),r=a("5fd9"),l=a("dd9a"),c=a("6172"),h=a("2883"),d=a("ec8a"),p=a("43e9"),u=a("1e94"),g=a("209c"),m=a("3418"),f=a("02c3"),w=a("14a6"),v=a("be1e"),D=a("b805"),y=a("bdfb"),S=a("7739"),b=a("cc61"),C=a("4061"),x=a("23aa"),k=a("4c64"),P=a("9ad6"),T=a("5155"),E=a("2f62"),Y=a("006f"),M=["crossBar"];e.a={name:"draw-screen",props:["model"],components:{lineComponent:s.a,pieComponent:l.a,radarComponent:c.a,tableComponent:v.a,treeComponent:D.a,textComponent:y.a,imageComponent:r.a,rectangleComponent:m.a,roundComponent:f.a,otherShapesComponent:w.a,dataobjComponent:S.a,moreComponent:b.a,dropdownComponent:C.a,reportWidgetComponent:x.a,paramWindow:k.a,drawRuler:P.a,drawThumbnail:T.a,crossBarComponent:h.a,funnelComponent:d.a,gaugeComponent:p.a,mapComponent:u.a,map3DComponent:g.a},data:function(){return{drawScalePercentage:"100%",startDrawScale:!1,showRight:!0,showThumbnail:!0,initLeft:0,initTop:0,selectType:"select",parentWidth:0,parentHeight:0,drawEventData:{mouseState:"",pageWidth:0,pageHeight:0,offsetX:0,offsetY:0,marginX:0,marginY:0,startX:0,startY:0,currentX:0,currentY:0,endX:0,endY:0,moveDistanceX:0,moveDistanceY:0,marginLeft:0,marginTop:0,scale:1,defaultScale:1,defaultScaleY:1},defaultData:{minLeft:60,minTop:60,defaultBlockWidth:200,defaultBlockHeight:150,minMoveDistance:1,contextmenuLineHeight:30,contextmenuWidth:180},maxSubMenuNum:4,contextMenu:{show:!1,subX:"left",subY:"top",style:{position:"absolute"},data:[{text:this.$t("design.drawCopy"),value:"copy"},{text:this.$t("design.drawPaste"),value:"paste"},{text:this.$t("design.drawGroup"),value:"group"},{text:this.$t("design.drawUnGroup"),value:"ungroup"},{text:this.$t("design.drawOrder"),value:"changeLevel",children:{style:{position:"absolute"},data:[{text:this.$t("design.drawMoveUp"),value:"moveUp"},{text:this.$t("design.drawMoveDown"),value:"moveDown"},{text:this.$t("design.drawMoveToTop"),value:"moveToTop"},{text:this.$t("design.drawMoveToBottom"),value:"moveToBottom"}]}},{text:this.$t("design.drawHorizontal"),value:"horizontal",children:{style:{position:"absolute"},data:[{text:this.$t("design.drawHorizontalLeft"),value:"horizontalLeft"},{text:this.$t("design.drawHorizontalCenter"),value:"horizontalCenter"},{text:this.$t("design.drawHorizontalRight"),value:"horizontalRight"}]}},{text:this.$t("design.drawVertical"),value:"vertical",children:{style:{position:"absolute"},data:[{text:this.$t("design.drawVerticalTop"),value:"verticalTop"},{text:this.$t("design.drawVerticalCenter"),value:"verticalCenter"},{text:this.$t("design.drawVerticalBottom"),value:"verticalBottom"}]}},{text:this.$t("design.drawDelete"),value:"delete"},{text:this.$t("design.drawReportSetting"),value:"reportSetting"},{text:this.$t("design.drawPageSetting"),value:"pageSetting"}]},contextMenuShow:{},showParamWindow:!1,popupWindowUser:"",selfUuid:"",isInit:!0,drawPanels:null,drawGroups:{},drawGroupCarouselInterval:{},oldDrawPosition:"",move:{ArrowUp:{direct:"top",flag:1},ArrowDown:{direct:"top",flag:-1},ArrowLeft:{direct:"left",flag:1},ArrowRight:{direct:"left",flag:-1}},lines:{h:[],v:[]}}},computed:Object(o.a)(Object(o.a)({resizerData:function(){var e=this,a={show:!1,position:{}};return 1===this.selected.length||(this._.forEach(this.selected,(function(i){var n=e.drawBlockContent[e.currentPage][i];n.selected&&(a.show=!0);var o=parseInt(n.position.top),s=parseInt(n.position.left),r=parseInt(n.position.height),l=parseInt(n.position.width);t.isEmptyObject(a.position)?a.position={top:o,left:s,bottom:o+r,right:s+l,"z-index":n.position["z-index"]}:(a.position.top=Math.min(a.position.top,o),a.position.left=Math.min(a.position.left,s),a.position.bottom=Math.max(a.position.bottom,o+r),a.position.right=Math.max(a.position.right,s+l),a.position["z-index"]=Math.max(a.position["z-index"],n.position["z-index"]))})),a.style={position:"absolute",top:a.position.top+"px",left:a.position.left+"px",height:"0",width:"0","z-index":a.position["z-index"]},a.resizer={top:a.position.top+"px",left:a.position.left+"px",height:a.position.bottom-a.position.top+"px",width:a.position.right-a.position.left+"px"},a.styleLeft={position:"absolute",top:"0",left:"0",height:a.position.bottom-a.position.top+"px",width:"1px"},a.styleRight={position:"absolute",top:"0",left:a.position.right-a.position.left-1+"px",height:a.position.bottom-a.position.top+"px",width:"1px"},a.styleTop={position:"absolute",top:"0",left:"0",height:"1px",width:a.position.right-a.position.left+"px"},a.styleBottom={position:"absolute",top:a.position.bottom-a.position.top-1+"px",left:"0",height:"1px",width:a.position.right-a.position.left+"px"},a.leftCenter={top:(a.position.bottom-a.position.top-1)/2+"px"},a.leftBottom={top:a.position.bottom-a.position.top-1+"px"},a.rightTop={left:a.position.right-a.position.left-1+"px"},a.rightCenter={top:(a.position.bottom-a.position.top-1)/2+"px",left:a.position.right-a.position.left-1+"px"},a.rightBottom={top:a.position.bottom-a.position.top-1+"px",left:a.position.right-a.position.left-1+"px"},a.topCenter={left:(a.position.right-a.position.left-1)/2+"px"},a.bottomCenter={top:a.position.bottom-a.position.top-1+"px",left:(a.position.right-a.position.left-1)/2+"px"}),a},drawBlockContent:function(){var e=t.extend(!0,{},this.blockContent);for(var a in e){this.drawGroups[a]?this._.forEach(this.drawGroups[a],(function(t){t.count=0})):this.drawGroups[a]={};for(var i=0;i<this.pageContent[a].length;i++){var n=this.pageContent[a][i];e[a][n].position.scale="edit"===this.model?1:this.drawEventData.scale>0?this.drawEventData.scale:1,e[a][n].position["z-index"]=e[a][n].selected?99999:i,"view"===this.model&&e[a][n].contentData.groupSetting&&e[a][n].contentData.groupSetting.isCarousel&&(this.drawGroups[a][e[a][n].group]||(this.drawGroups[a][e[a][n].group]={currentIndex:1,count:0}),e[a][n].contentData.groupSetting.currentIndex=e[a][n].contentData.groupSetting.currentIndex||1,this.drawGroups[a][e[a][n].group].count=this.drawGroups[a][e[a][n].group].count+1,e[a][n].contentData.groupSetting.index=this.drawGroups[a][e[a][n].group].count)}}return e},pageSize:function(){var t=this.defaultData.minTop,e=this.defaultData.minLeft;"view"===this.model&&!1===this.reportSetting.showPadding&&(t=0,e=0);var a=Object.assign({},this.drawSize),i=this.parentWidth-2*e,n=this.parentHeight-2*t;return this.drawEventData.pageWidth===parseFloat(this.drawSize.width)&&this.drawEventData.pageHeight===parseFloat(this.drawSize.height)||(this.drawEventData.defaultScale=1),this.drawEventData.pageWidth=parseFloat(this.drawSize.width),this.drawEventData.pageHeight=parseFloat(this.drawSize.height),"edit"===this.model&&(this.reportSetting.showPadding||(this.drawEventData.pageWidth=this.drawEventData.pageWidth+1),a.width=this.drawEventData.pageWidth+"px",a.height=this.drawEventData.pageHeight+"px",a.top="".concat(t,"px"),a.left="".concat(e,"px")),(this.drawEventData.pageWidth>i||"view"===this.model&&this.reportSetting.fullScreen)&&(this.drawEventData.defaultScale=i/this.drawEventData.pageWidth,this.drawEventData.defaultScaleY=n/this.drawEventData.pageHeight),this.drawEventData.scale=this.startDrawScale?this.drawEventData.scale:this.drawEventData.defaultScale,"edit"===this.model?this.drawScalePercentage=Math.round(100*this.drawEventData.scale)+"%":this.drawEventData.scale="".concat(this.drawEventData.defaultScale,", ").concat(this.drawEventData.defaultScaleY),a.transform="scale("+this.drawEventData.scale+")",a},transformPageStyle:function(){var t,e={},a=Object(n.a)(this.pageList);try{for(a.s();!(t=a.n()).done;){var i=t.value,o=Object.assign({position:"absolute"},this.reportStyle.pageStyle,this.pageStyle[i],this.pageSize);e[i]=o,this.reportSetting.showPadding||"edit"!==this.model||(e[i].border="1px dashed rgba(0,0,0,0.26)")}}catch(t){a.e(t)}finally{a.f()}return e},transformGraticuleStyle:function(){var e,a={},i={},o=Object(n.a)(this.pageList);try{for(o.s();!(e=o.n()).done;){var s=e.value,r=Object.assign({position:"absolute"},this.reportStyle.pageStyle,this.pageStyle[s],this.pageSize);a[s]=r,this.reportSetting.showPadding||"edit"!==this.model||(a[s].border="1px dashed rgba(0,0,0,0.26)")}}catch(t){o.e(t)}finally{o.f()}for(var l in a)i[l]={},a[l].backgroundImage&&!t.isEmptyObject(a[l].backgroundImage)&&a[l].backgroundImage.url&&(i[l].backgroundPosition=a[l].backgroundPositionX+" "+a[l].backgroundPositionY,i[l].backgroundRepeat=a[l].backgroundRepeat,i[l].backgroundSize=a[l].backgroundSize,i[l].backgroundImage="url("+(a[l].backgroundImage.isLocal?this.$projectName:"")+a[l].backgroundImage.url+")");return i},pageBoxStyle:function(){var t=this.defaultData.minTop,e=this.defaultData.minLeft,a=this.drawEventData.scale,i="100%",n=this.drawEventData.pageHeight*("view"===this.model?this.drawEventData.defaultScaleY:a);n=this.$el&&this.$el.offsetHeight>n?n+(this.$el.offsetHeight-n):n;var o="none";if("view"===this.model)this.reportSetting.showPadding,this.reportSetting.showDirection&&(i="auto",o="left");else{var s=this.parentWidth-2*e,r=this.parentHeight-2*t;i=this.drawEventData.pageWidth*a,i=this.$el&&this.$el.offsetWidth>i?i+(this.$el.offsetWidth-i):i;var l=s/(this.drawEventData.pageWidth*a),c=r/(this.drawEventData.pageHeight*a);i=(l<=1?parseFloat(i)+(a>=this.drawEventData.defaultScale?350*a:0):i)+"px",n=c<=1.2?n+300*a:n}return{width:i,height:n+"px",cursor:this.toolbarType!==this.selectType||"select"===this.drawEventData.mouseState||"create"===this.drawEventData.mouseState?"crosshair":"default",float:o}},padStyle:function(){var t="100%";if("view"===this.model&&this.reportSetting.showDirection){t=0;var e,a=Object(n.a)(this.pageList);try{for(a.s();!(e=a.n()).done;){var i=e.value,o=Object.assign({position:"relative"},this.reportStyle.pageStyle,this.pageStyle[i],this.pageSize);t+=parseFloat(o.width)}}catch(t){a.e(t)}finally{a.f()}t+="px"}return{position:"relative",width:t,height:"100%",overflow:"auto",cursor:this.toolbarType!==this.selectType||"select"===this.drawEventData.mouseState||"create"===this.drawEventData.mouseState?"crosshair":"default"}},nanoscrollerStyle:function(){return!this.reportSetting.showPadding&&this.model,{}},auxiliaryFrameStyle:function(){var t=this.drawEventData,e=Math.min(t.startX,t.currentX),a=Math.min(t.startY,t.currentY),i=Math.max(t.startX,t.currentX),n=Math.max(t.startY,t.currentY),o={position:"absolute"};return"select"!==t.mouseState&&"create"!==t.mouseState||(o.top=a-t.offsetY+"px",o.left=e-t.offsetX+"px",o.height=n-a+"px",o.width=i-e+"px"),o},showReportParam:function(){var t=!1;return this.paramSettingWithKey.length>0&&(t=!0),t},showBolckArea:function(){var t=this;return function(e){return e.contentData.groupSetting&&e.contentData.groupSetting.isCarousel?e.contentData.groupSetting.currentIndex===e.contentData.groupSetting.index:"edit"===t.model||(void 0===e.contentData.show||e.contentData.show)}}},Object(E.d)({popupWindowClick:function(t){return t.popupWindowClick},drawSize:function(t){return t.draw.drawSize},reportStyle:function(t){return t.draw.reportStyle},reportSetting:function(t){return t.draw.reportSetting},pageStyle:function(t){return t.draw.pageStyle},currentPage:function(t){return t.draw.currentPage},blockContent:function(t){return t.draw.blockContent},pageContent:function(t){return t.draw.pageContent},selected:function(t){return t.draw.selected},lastAddPage:function(t){return t.draw.lastAddPage},lastDeletePage:function(t){return t.draw.lastDeletePage},dataForToggleType:function(t){return t.draw.dataForToggleType},pageList:function(t){return t.pageController.pageList},toolbarType:function(t){return t.toolbar.currentType},paramStyleSetting:function(t){return t.reportParam.paramStyleSetting},paramSelectValue:function(t){return t.reportParam.paramSelectValue},paramDefaultValue:function(t){return t.reportParam.paramDefaultValue},showLogo:function(t){return t.reportParam.showLogo}})),Object(E.c)({selectedData:"selectedData",selectedType:"selectedType",loadingState:"loadingState",paramSettingWithKey:"paramSettingWithKey",paramCurrentValue:"paramCurrentValue",paramToBlock:"paramToBlock",groupData:"groupData"})),watch:{selected:function(){var t,e="",a=[],i=!0,o=Object(n.a)(this.selected);try{for(o.s();!(t=o.n()).done;){var s=t.value;this.drawBlockContent[this.currentPage][s].group?a.includes(this.drawBlockContent[this.currentPage][s].group)||a.push(this.drawBlockContent[this.currentPage][s].group):i=!1}}catch(t){o.e(t)}finally{o.f()}e=0===this.selected.length?"reportSetting":1===this.selected.length?this.selectedType[0]:i&&1===a.length?"group":"multiple",this.changeParamType(e)},popupWindowClick:function(){switch(this.popupWindowUser){case"copyExceed":this.hidePopupWindow(),this.popupWindowUser=""}},currentPage:function(){var t=this;"all"===this.currentPage?this.$nextTick((function(){t.drawAddPanel(t.$refs.drawPanel)})):this.$nextTick((function(){t.$refs.drawPanel&&t.drawAddPanel(t.$refs.drawPanel[0])}))},groupData:function(){this.isInit&&"view"===this.model&&(this.startAutoCarousel(),this.isInit=!1)},drawScalePercentage:function(t){var e=parseInt(t);this.$nextTick((function(){var t=document.getElementById("scrollBar").children[0],a=document.getElementById("scrollBar").children[1];20===e?(t.style.left="0",a.style.width="0"):e>20&&e<100?(a.style.width=45*(1-(100-e)/100)+"px",t.style.left=45*(1-(100-e)/100)+"px"):100===e?(t.style.left="45px",a.style.width="45px"):(a.style.width=45*(1+(e-100)/100)+"px",t.style.left=45*(1+(e-100)/100)+"px")}))}},methods:Object(o.a)({comName:function(t){var e,a=Object(n.a)(M);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(t.type.startsWith(i))return i+"Component"}}catch(t){a.e(t)}finally{a.f()}return("bar"===t.type?"line":t.type)+"Component"},clickParamButton:function(){"view"===this.model&&(this.showParamWindow=!0)},selectParam:function(t,e){"confirm"===t.type&&this.changeReportParamSelectValue(e),this.showParamWindow=!1},setParentWidth:function(){this.$nextTick((function(){this.parentWidth=this.$el.parentNode.clientWidth}))},setParentHeight:function(){this.$nextTick((function(){this.parentHeight=this.$el.parentNode.clientHeight}))},setShowRight:function(t){this.showRight=t},handleScroll:function(){t(".design-panel-wrap").scrollTop()!==this.drawEventData.marginTop&&(this.drawEventData.vertical=!1),t(".design-panel-wrap").scrollLeft()!==this.drawEventData.marginLeft&&(this.drawEventData.vertical=!0),this.drawEventData.marginTop=t(".design-panel-wrap").scrollTop(),this.drawEventData.marginLeft=t(".design-panel-wrap").scrollLeft()},handleLine:function(t){this.lines=t},changeScrollPosition:function(e,a,i){t(".design-panel-wrap").scrollLeft(e/i),t(".design-panel-wrap").scrollTop(a/i)},mousedown:function(e){if(this.initLeft=e.offsetX,this.initTop=e.offsetY,"view"!==this.model&&this.currentPage){this.contextMenu.show=!1;var a=parseFloat(t(this.$el).scrollTop()),i=parseFloat(t(this.$el).scrollLeft());this.drawEventData.offsetX=t(this.$el).parent().offset().left,this.drawEventData.offsetY=t(this.$el).parent().offset().top,this.drawEventData.marginX=parseFloat(t(this.$el).find('[editRole="'+this.currentPage+'"]')[0].offsetLeft),this.drawEventData.marginY=parseFloat(t(this.$el).find('[editRole="'+this.currentPage+'"]')[0].offsetTop),this.drawEventData.startX=e.pageX+i,this.drawEventData.startY=e.pageY+a,this.drawEventData.currentX=e.pageX+i,this.drawEventData.currentY=e.pageY+a;var n=t(e.target),o="bolck"===n.attr("editRole")?n:n.parents('[editRole="bolck"]');if(this.toolbarType===this.selectType)if(1===e.which)if(e.ctrlKey)this.drawEventData.mouseState="ctrlSelect";else if(1===n.parents('[editRole="border"]').length)this.drawEventData.mouseState=n.attr("editRole");else if(1===o.length){var s=o.attr("name");this.drawBlockContent[this.currentPage][s].selected?1===this.selected.length?this.drawBlockContent[this.currentPage][s].group?this.drawEventData.mouseState="selectSingle":this.drawEventData.mouseState="move":this.drawEventData.mouseState="selectSingle":(this.selectSingle(s),this.drawEventData.mouseState="move")}else{if("guide"===e.toElement.className)return;this.drawEventData.mouseState="select"}else 3===e.which&&(this.drawEventData.mouseState="contextMenu");else 1===e.which&&(this.emptySelect(),this.drawEventData.mouseState="create")}},mousemove:function(e){if("view"!==this.model&&this.currentPage){0===e.which&&this.drawEventData.mouseState&&this.emptyDrawEventData();var a=parseFloat(t(this.$el).scrollTop()),i=parseFloat(t(this.$el).scrollLeft());switch(this.drawEventData.mouseState){case"select":case"create":this.showThumbnail=!1,this.drawEventData.currentX=e.pageX+i,this.drawEventData.currentY=e.pageY+a;break;case"selectSingle":e.pageX===this.drawEventData.startX&&e.pageY+a===this.drawEventData.startY||(this.drawEventData.mouseState="move",this.drawEventData.currentX=e.pageX+i,this.drawEventData.currentY=e.pageY+a);break;case"move":var n=e.pageX+i,o=e.pageY+a;this.moveSelect("ing",n,o);break;case"leftTop":case"leftCenter":case"leftBottom":case"rightTop":case"rightCenter":case"rightBottom":case"topCenter":case"bottomCenter":var s=e.pageX+i,r=e.pageY+a;this.changeSize(this.drawEventData.mouseState,"ing",s,r)}}},mouseup:function(e){if("view"!==this.model&&this.currentPage){var a=parseFloat(t(this.$el).scrollTop()),i=parseFloat(t(this.$el).scrollLeft());this.drawEventData.endX=e.pageX+i,this.drawEventData.endY=e.pageY+a;var n="bolck"===t(e.target).attr("editRole")?t(e.target):t(e.target).parents('[editRole="bolck"]');switch(this.drawEventData.mouseState){case"select":this.emptySelect(),this.selectArea();break;case"create":this.createArea();break;case"ctrlSelect":1===n.length&&e.ctrlKey&&this.selectSingle(n.attr("name"),"ctrl");break;case"selectSingle":this.selectSingle(n.attr("name"));break;case"move":this.moveSelect("end");break;case"contextMenu":this.showContextMenu(n);break;case"leftTop":case"leftCenter":case"leftBottom":case"rightTop":case"rightCenter":case"rightBottom":case"topCenter":case"bottomCenter":this.changeSize(this.drawEventData.mouseState,"end")}this.toolbarType!==this.selectType&&this.changeType(this.selectType),this.emptyDrawEventData(),this.showThumbnail=!0}},mouseleave:function(){if("view"!==this.model&&this.currentPage){switch(this.contextMenu.show=!1,this.drawEventData.endX=this.drawEventData.currentX,this.drawEventData.endY=this.drawEventData.currentY,this.drawEventData.mouseState){case"select":this.emptySelect(),this.selectArea();break;case"create":this.emptySelect(),this.createArea();break;case"ctrlSelect":case"selectSingle":break;case"move":this.moveSelect("end");break;case"contextMenu":break;case"leftTop":case"leftCenter":case"leftBottom":case"rightTop":case"rightCenter":case"rightBottom":case"topCenter":case"bottomCenter":this.changeSize(this.drawEventData.mouseState,"end")}""!==this.drawEventData.mouseState&&(this.toolbarType!==this.selectType&&this.changeType(this.selectType),this.emptyDrawEventData())}},showContextMenu:function(t){if(t.length>0){var e=t.attr("name");this.drawBlockContent[this.currentPage][e].selected||this.selectSingle(e)}else this.emptySelect();var a=this.drawEventData,i=this.contextMenu,o=0,s={};if(0===this.selected.length)s={reportSetting:!0,pageSetting:!0,addHorizontalLline:!0,addVerticalLline:!0},o=4;else{if(s={changeLevel:!0,delete:!0,copy:!0},o=3,1===this.selected.length&&this.drawBlockContent[this.currentPage][this.selected[0]].group)s.ungroup=!0;else if(this.selected.length>1){var r=[];s.horizontal=!0,s.vertical=!0;var l,c=Object(n.a)(this.selected);try{for(c.s();!(l=c.n()).done;){var h=l.value;this.drawBlockContent[this.currentPage][h].group?(s.ungroup=!0,r.includes(this.drawBlockContent[this.currentPage][h].group)||r.push(this.drawBlockContent[this.currentPage][h].group)):s.group=!0}}catch(t){c.e(t)}finally{c.f()}r.length>1&&(s.group=!0)}!0===s.ungroup&&(o+=1),!0===s.group&&(o+=1)}var d=localStorage.getItem("copy"),p=d?JSON.parse(d):{};(p.copyContent?p.copyContent:[]).length>0&&(s.paste=!0,o+=1),this.contextMenuShow=s;var u=this.defaultData.contextmenuLineHeight,g=o*u,m=this.maxSubMenuNum*u,f=this.defaultData.contextmenuWidth,w=document.body.clientHeight,v=this.parentWidth;a.endX-a.offsetX+f>v?(i.style.left=a.endX-a.offsetX-f+"px",i.subX="right"):(i.style.left=a.endX-a.offsetX+"px",a.endX-a.offsetX+2*f>v?i.subX="right":i.subX="left"),a.endY+g>w?(i.style.top=a.endY-a.offsetY-g+"px",i.subY="bottom"):(i.style.top=a.endY-a.offsetY+"px",a.endY+g+m>w?i.subY="bottom":i.subY="top"),i.show=!0},clickMenu:function(t){var e=Object(i.a)(this.selected);switch(t){case"reportSetting":case"pageSetting":this.changeParamType(t);break;case"copy":this.copySelected();break;case"paste":this.pasteCopies();break;case"group":this.groupAndUngroup("group",e);break;case"ungroup":this.groupAndUngroup("ungroup",e);break;case"changeLevel":break;case"delete":this.deleteSelected();break;case"moveUp":this.changeLevel("moveUp");break;case"moveDown":this.changeLevel("moveDown");break;case"moveToTop":this.changeLevel("moveToTop");break;case"moveToBottom":this.changeLevel("moveToBottom");break;case"horizontalLeft":case"horizontalCenter":case"horizontalRight":case"verticalTop":case"verticalCenter":case"verticalBottom":this.changeAlignment(t)}this.contextMenu.show=!1},scaleMounsedown:function(t){var e=this;this.$nextTick((function(){var a=document.getElementById("scrollBar").children[0],i=document.getElementById("scrollBar").children[1],n=(t||window.event).clientX-a.offsetLeft,o=1,s=e;document.onmousemove=function(t){var e=t||window.event;a.style.left=e.clientX-n+"px";var r=parseInt(a.style.left);r<0?a.style.left=0:r>90&&(a.style.left="90px"),i.style.width=a.style.left;var l=parseInt(parseInt(a.style.left)/90*100);0===l?o=.2:50===l?o=1:100===l?o=2:l>0&&l<50?o=.2+.8*l/50:l>50&&l<100&&(o=1+(l-50)/50*1),s.startDrawScale=!0,s.drawScalePercentage=Math.round(100*o)+"%",s.drawEventData.scale=o,window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),document.onmouseup=function(){document.onmousemove=null}}}))},scaleClick:function(t){var e=this,a=parseInt(this.drawScalePercentage);1===t&&a<200?this.drawScalePercentage=a+10+"%":1===t&&a>200?this.drawScalePercentage="200%":0===t&&a<=200&&a>20?this.drawScalePercentage=a-10+"%":0===t&&a<=20&&(this.drawScalePercentage="20%"),this.$nextTick((function(){e.startDrawScale=!0,e.drawEventData.scale=parseInt(e.drawScalePercentage)/100}))},changeLevel:function(t){var e=Object(i.a)(this.pageContent[this.currentPage]);if("moveUp"===t){for(var a=e.length-1;a>=0;a--)if(this.drawBlockContent[this.currentPage][e[a]].selected&&e[a+1]&&!this.drawBlockContent[this.currentPage][e[a+1]].selected){var n=[e[a+1],e[a]];e[a]=n[0],e[a+1]=n[1]}}else if("moveDown"===t){for(var o=0;o<e.length;o++)if(this.drawBlockContent[this.currentPage][e[o]].selected&&e[o-1]&&!this.drawBlockContent[this.currentPage][e[o-1]].selected){var s=[e[o-1],e[o]];e[o]=s[0],e[o-1]=s[1]}}else{for(var r=[],l=[],c=0;c<e.length;c++)this.drawBlockContent[this.currentPage][e[c]].selected?r.push(e[c]):l.push(e[c]);"moveToTop"===t?e=[].concat(l,r):"moveToBottom"===t&&(e=[].concat(r,l))}this.changeIndex(e)},groupAndUngroup:function(t,e){if("group"===t)this.groupBlock(e),this.changeParamType("group");else if("ungroup"===t)if(1===e.length)if(2===this.groupData[this.currentPage][this.drawBlockContent[this.currentPage][e[0]].group].children.length){var a=Object(i.a)(this.groupData[this.currentPage][this.drawBlockContent[this.currentPage][e[0]].group].children);this.ungroupBlock(a)}else this.ungroupBlock(e);else this.ungroupBlock(e),this.changeParamType("multiple")},copySelected:function(){if(this.selectedData.length>0){var t=localStorage.getItem("copy"),e={uuid:this.selfUuid,copyContent:this.selectedData},a=JSON.stringify(e);try{localStorage.setItem("copy",""),localStorage.setItem("copy",a)}catch(t){}if(localStorage.getItem("copy")!==a){localStorage.setItem("copy",t);var i={show:!0,type:"alert",content:this.$t("design.drawCopyExceed"),style:{width:"300px",height:"120px"}};this.popupWindowUser="copyExceed",this.showPopupWindow(i)}}},pasteCopies:function(){var e=this.defaultData.minMoveDistance,a=parseFloat(this.drawSize.width),i=parseFloat(this.drawSize.height),n=localStorage.getItem("copy"),o=n?JSON.parse(n):{},s=o.copyContent?o.copyContent:[];if(s.length>0){s[0].contentData.dataSource?s[0].contentData.dataSource.filterRules=[]:s[0].contentData.dataresource&&(s[0].contentData.dataresource.filterRules=[]);for(var r=0;r<s.length;r++){var l={top:parseInt(s[r].position.top)+e+"px",left:parseInt(s[r].position.left)+e+"px"};s[r].position=t.extend(!0,{},s[r].position,l)}o.copyContent=s;var c=JSON.stringify(o);try{localStorage.setItem("copy",c)}catch(t){}for(var h=0;h<s.length;h++){var d=parseInt(s[h].position.top),p=parseInt(s[h].position.left),u=parseInt(s[h].position.height),g=parseInt(s[h].position.width),m={};p<0?m.left="0px":p+g>a&&(m.left=a-g+"px"),d<0?m.top="0px":d+u>i&&(m.top=i-u+"px"),s[h].position=t.extend(!0,{},s[h].position,m)}this.emptySelect(),this.pasteBlock(s)}},changeAlignment:function(t){var e,a,i,n,o=this,s={};this._.forEach(this.selected,(function(t,s){var r=o.drawBlockContent[o.currentPage][t],l=o._.mapValues(r.position,(function(t){return parseFloat(t)}));0===s?(e=l.left,a=l.top,i=l.left+l.width,n=l.top+l.height):(e=e>l.left?l.left:e,a=a>l.top?l.top:a,i=i<l.left+l.width?l.left+l.width:i,n=n<l.top+l.height?l.top+l.height:n)})),this._.forEach(this.selected,(function(r){s[r]={};var l=o.drawBlockContent[o.currentPage][r],c=o._.mapValues(l.position,(function(t){return parseFloat(t)}));switch(t){case"horizontalLeft":s[r].left=e+"px";break;case"horizontalRight":s[r].left=i-c.width+"px";break;case"horizontalCenter":var h=(e+i)/2;s[r].left=h-c.width/2+"px";break;case"verticalTop":s[r].top=a+"px";break;case"verticalBottom":s[r].top=n-c.height+"px";break;case"verticalCenter":var d=(a+n)/2;s[r].top=d-c.height/2+"px"}})),this.changePosition(s)},emptyDrawEventData:function(){this.drawEventData.mouseState="",this.drawEventData.marginX=0,this.drawEventData.marginY=0,this.drawEventData.startX=0,this.drawEventData.startY=0,this.drawEventData.currentX=0,this.drawEventData.currentY=0,this.drawEventData.endX=0,this.drawEventData.endY=0,this.drawEventData.moveDistanceX=0,this.drawEventData.moveDistanceY=0},calculateSize:function(t,e,a,i,n){a=a||0===a?a:t,i=i||0===i?i:e;var o=this.drawEventData,s=n?Math.min(t,a):t,r=n?Math.min(e,i):e,l=n?Math.max(t,a):a,c=n?Math.max(e,i):i,h={};return r<=o.offsetY+o.marginY?h.top=r-o.offsetY-o.marginY:r>=o.offsetY+o.marginY+o.pageHeight*o.scale?h.top=o.pageHeight+(r-o.offsetY-o.marginY-o.pageHeight*o.scale):h.top=(r-o.offsetY-o.marginY)/o.scale,s<=o.offsetX+o.marginX?h.left=s-o.offsetX-o.marginX:s>=o.offsetX+o.marginX+o.pageWidth*o.scale?h.left=o.pageWidth+(s-o.offsetX-o.marginX-o.pageWidth*o.scale):h.left=(s-o.offsetX-o.marginX)/o.scale,c<=o.offsetY+o.marginY?h.bottom=c-o.offsetY-o.marginY:c>=o.offsetY+o.marginY+o.pageHeight*o.scale?h.bottom=o.pageHeight+(c-o.offsetY-o.marginY-o.pageHeight*o.scale):h.bottom=(c-o.offsetY-o.marginY)/o.scale,l<=o.offsetX+o.marginX?h.right=l-o.offsetX-o.marginX:l>=o.offsetX+o.marginX+o.pageWidth*o.scale?h.right=o.pageWidth+(l-o.offsetX-o.marginX-o.pageWidth*o.scale):h.right=(l-o.offsetX-o.marginX)/o.scale,h},changeSize:function(t,e,a,i){var n,o=this,s=this.drawEventData,r=!1,l={};if("end"===e)n=this.calculateSize(s.startX,s.startY,s.endX,s.endY),r=!0;else{var c=this.calculateSize(s.startX,s.startY,s.currentX,s.currentY),h=this.calculateSize(s.startX,s.startY,a,i);c.left=h.left=Math.round(c.left/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance,c.top=h.top=Math.round(c.top/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance;var d=parseInt((c.right-c.left)/this.defaultData.minMoveDistance)!==parseInt((h.right-h.left)/this.defaultData.minMoveDistance),p=parseInt((c.bottom-c.top)/this.defaultData.minMoveDistance)!==parseInt((h.bottom-h.top)/this.defaultData.minMoveDistance);(d||p)&&(s.currentX=a,s.currentY=i,n=h,r=!0)}if(r){var u=parseInt((n.right-n.left)/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance,g=parseInt((n.bottom-n.top)/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance;this._.forEach(this.selected,(function(e){var a=o.drawBlockContent[o.currentPage][e],i=o._.mapValues(a.position,(function(t){return parseFloat(t)})),n=o._.mapValues(o.selected.length>1?o.resizerData.resizer:a.position,(function(t){return parseFloat(t)}));n.width=n.width<=1?1:n.width,n.height=n.height<=1?1:n.height,i.width=i.width<=1?1:i.width,i.height=i.height<=1?1:i.height;var r=o._.cloneDeep(n);switch(l[e]={},t){case"leftTop":r.top=r.top-s.moveDistanceY+g,r.left=r.left-s.moveDistanceX+u,r.height=r.height+s.moveDistanceY-g,r.width=r.width+s.moveDistanceX-u;break;case"leftCenter":r.left=r.left-s.moveDistanceX+u,r.width=r.width+s.moveDistanceX-u;break;case"leftBottom":r.left=r.left-s.moveDistanceX+u,r.height=r.height-s.moveDistanceY+g,r.width=r.width+s.moveDistanceX-u;break;case"rightTop":r.top=r.top-s.moveDistanceY+g,r.height=r.height+s.moveDistanceY-g,r.width=r.width-s.moveDistanceX+u;break;case"rightCenter":r.width=r.width-s.moveDistanceX+u;break;case"rightBottom":r.width=r.width-s.moveDistanceX+u,r.height=r.height-s.moveDistanceY+g;break;case"topCenter":r.top=r.top-s.moveDistanceY+g,r.height=r.height+s.moveDistanceY-g;break;case"bottomCenter":r.height=r.height-s.moveDistanceY+g}l[e].top=Math.round(i.top+(r.top-n.top)+(i.top-n.top)/n.height*(r.height-n.height))+"px",l[e].left=Math.round(i.left+(r.left-n.left)+(i.left-n.left)/n.width*(r.width-n.width))+"px",l[e].width=Math.round(r.width/n.width*i.width)+"px",l[e].height=Math.round(r.height/n.height*i.height)+"px"})),s.moveDistanceY=g,s.moveDistanceX=u,this.changePosition(l)}},moveSelect:function(t,e,a){var i,n=this.drawEventData,o=!1,s={};if("end"===t)i=this.calculateSize(n.startX,n.startY,n.endX,n.endY),o=!0,this.isPosition=!1;else{var r=this.calculateSize(n.startX,n.startY,n.currentX,n.currentY),l=this.calculateSize(n.startX,n.startY,e,a),c=parseInt((r.right-r.left)/this.defaultData.minMoveDistance)!==parseInt((l.right-l.left)/this.defaultData.minMoveDistance),h=parseInt((r.bottom-r.top)/this.defaultData.minMoveDistance)!==parseInt((l.bottom-l.top)/this.defaultData.minMoveDistance);(c||h)&&(n.currentX=e,n.currentY=a,i=l,o=!0)}if(o){var d=parseInt((i.right-i.left)/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance,p=parseInt((i.bottom-i.top)/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance;for(var u in this.selected){var g=this.selected[u];s[g]={};var m=this.drawBlockContent[this.currentPage][g];s[g].top=Math.round(parseFloat(m.position.top)/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance-n.moveDistanceY+p+"px",s[g].left=Math.round(parseFloat(m.position.left)/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance-n.moveDistanceX+d+"px"}n.moveDistanceY=p,n.moveDistanceX=d,this.changePosition(s)}},selectArea:function(){var t=[],e=this.drawEventData,a=this.calculateSize(e.startX,e.startY,e.endX,e.endY,!0);for(var i in this.drawBlockContent[this.currentPage]){var o=this.drawBlockContent[this.currentPage][i],s=parseFloat(o.position.top),r=parseFloat(o.position.left),l=parseFloat(o.position.top)+parseFloat(o.position.height),c=parseFloat(o.position.left)+parseFloat(o.position.width),h=a.left<=r&&r<=a.right,d=a.left<=c&&c<=a.right,p=r<=a.left&&a.right<=c,u=a.top<=s&&s<=a.bottom,g=a.top<=l&&l<=a.bottom,m=s<=a.top&&a.bottom<=l;if((h||d||p)&&(u||g||m)&&(t.includes(o.id)||t.push(o.id),o.group)){var f,w=Object(n.a)(this.groupData[this.currentPage][o.group].children);try{for(w.s();!(f=w.n()).done;){var v=f.value;t.includes(v)||t.push(v)}}catch(t){w.e(t)}finally{w.f()}}}for(var D=0,y=t;D<y.length;D++){var S=y[D];this.triggerSelect(S)}},selectSingle:function(t,e){var a,o=this,s=this.drawBlockContent[this.currentPage][t].group,r=[],l=!1,c=[],h={empty:!1,completeSelectedGroup:!1,clickedGroup:!1,clickedSelf:!1},d=Object(n.a)(this.selected);try{for(d.s();!(a=d.n()).done;){var p=a.value;this.drawBlockContent[this.currentPage][p].group&&(r.includes(this.drawBlockContent[this.currentPage][p].group)||r.push(this.drawBlockContent[this.currentPage][p].group))}}catch(t){d.e(t)}finally{d.f()}if(s){if((c=Object(i.a)(this.groupData[this.currentPage][s].children)).length===this.selected.length){l=!0;var u,g=Object(n.a)(this.selected);try{for(g.s();!(u=g.n()).done;){var m=u.value;c.includes(m)||(l=!1)}}catch(t){g.e(t)}finally{g.f()}}}else c=[t];1===r.length&&1===this.selected.length?s===r[0]?"ctrl"===e||this.drawBlockContent[this.currentPage][t].selected?h.completeSelectedGroup=!0:(h.empty=!0,h.clickedSelf=!0):"ctrl"===e?(h.completeSelectedGroup=!0,h.clickedGroup=!0):(h.empty=!0,h.clickedGroup=!0):l?"ctrl"===e?h.clickedGroup=!0:(h.empty=!0,h.clickedSelf=!0):("ctrl"===e||(h.empty=!0),h.clickedGroup=!0),this.$nextTick((function(){if(h.empty&&o.emptySelect(),h.completeSelectedGroup){var e,a=Object(i.a)(o.groupData[o.currentPage][r[0]].children),s=Object(n.a)(a);try{for(s.s();!(e=s.n()).done;){var l=e.value;o.drawBlockContent[o.currentPage][l].selected||o.triggerSelect(l)}}catch(t){s.e(t)}finally{s.f()}}if(h.clickedGroup){var d,p=Object(n.a)(c);try{for(p.s();!(d=p.n()).done;){var u=d.value;o.triggerSelect(u)}}catch(t){p.e(t)}finally{p.f()}}h.clickedSelf&&o.triggerSelect(t)}))},createArea:function(){var t=this.drawEventData,e={type:this.toolbarType,selected:!1,position:{position:"absolute"},group:"",contentData:{}},a=this.calculateSize(t.startX,t.startY,t.endX,t.endY,!0);a.top=Math.round(a.top/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance,a.bottom=Math.round(a.bottom/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance,a.left=Math.round(a.left/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance,a.right=Math.round(a.right/this.defaultData.minMoveDistance)*this.defaultData.minMoveDistance,e.position.top=a.top+"px",e.position.left=a.left+"px";var i=a.bottom-a.top,n=a.right-a.left,o=i||this.defaultData.defaultBlockHeight,s=n||this.defaultData.defaultBlockWidth;e.position.height=o+"px",e.position.width=s+"px",this.addBlock(e)},uuidBuilder:function(t,e){var a,i,n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[];if(e=e||n.length,t)for(a=0;a<t;a++)o[a]=n[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",a=0;a<36;a++)o[a]||(i=0|16*Math.random(),o[a]=n[19===a?3&i|8:i]);return o.join("")},startAutoCarousel:function(){var t=this;t._.forEach(t.groupData,(function(e,a){t._.forEach(e,(function(e,i){if(e.setting&&t._.get(e,"setting.isCarousel")&&"auto"===t._.get(e,"setting.groupCarouselTrigger")){var n=0;clearInterval(t.drawGroupCarouselInterval[i]),t.drawGroupCarouselInterval[i]=setInterval((function(){(n=t.drawGroups[a][i].currentIndex+1)===t.drawGroups[a][i].count+1&&(n=1),t.drawGroups[a][i].currentIndex=n;var o={};t._.forEach(e.children,(function(t){o[t]={groupSetting:{currentIndex:n}}})),t.drawChangeSpecialDatas(o)}),e.setting.carouselTime)}}))}))}},Object(E.b)({showPopupWindow:"showPopupWindow",hidePopupWindow:"hidePopupWindow",emptySelect:"_drawEmptySelected",addBlock:"_drawAddBlock",triggerSelect:"_drawTriggerSelect",deleteSelected:"_drawDeleteSelected",changePosition:"_drawChangeBlockPosition",changeAllPosition:"_drawChangeAllBlockPosition",groupBlock:"_drawGroup",ungroupBlock:"_drawUngroup",pasteBlock:"_drawPasteBlock",selectAll:"_drawSelectedAll",changeParamType:"_drawChangeParamType",changeIndex:"_drawChangeIndex",changeType:"getType",changeReportParamSelectValue:"changeReportParamSelectValue",drawAddPanel:"drawAddPanel",drawChangeSpecialDatas:"drawChangeSpecialDatas",drawRestoreData:"drawRestoreData"})),beforeMount:function(){document.body.setAttribute("data-theme","dark"),Object(Y.c)()},beforeDestroy:function(){document.body.setAttribute("data-theme","dap")},mounted:function(){var t=this,e=this,a=[37,38,39,40];this.setParentWidth(),this.setParentHeight(),"edit"===this.model&&(window.onkeydown=function(t){var i=t.target.tagName.toUpperCase();if("INPUT"!==i&&"TEXTAREA"!==i||t.target.className.includes("dropDown-true-input")){46===t.keyCode||8===t.keyCode?e.deleteSelected():65===t.keyCode&&t.ctrlKey?e.selectAll():67===t.keyCode&&t.ctrlKey||67===t.keyCode&&t.metaKey?e.copySelected():(86===t.keyCode&&t.ctrlKey||86===t.keyCode&&t.metaKey)&&e.pasteCopies();var n={};if(a.includes(t.keyCode)){for(var o in t.preventDefault(),e.selected){var s=e.selected[o];n[s]={};var r=e.drawBlockContent[e.currentPage][s];n[s][e.move[t.key].direct]=parseFloat(r.position[e.move[t.key].direct])-e.defaultData.minMoveDistance*e.move[t.key].flag+"px"}e.changePosition(n)}}},window.onbeforeunload=function(){var t=localStorage.getItem("copy");(t?JSON.parse(t):{}).uuid===e.selfUuid&&localStorage.setItem("copy","")},window.onstorage=function(){},window.addEventListener("scroll",e.handleScroll,!0)),window.addEventListener("resize",(function(){t.setParentWidth(),t.setParentHeight()}))},created:function(){this.selfUuid=this.uuidBuilder()}}}).call(this,a("1157"))},2536:function(t,e,a){},3631:function(t,e,a){"use strict";var i=a("2536");a.n(i).a},"3c67":function(t,e,a){"use strict";a.r(e);var i=a("e483").a,n=(a("dc3d"),a("2877")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view",on:{click:t.hideSomething,mouseleave:t.mouseLeave,mousemove:t.mousemove}},[t.showAll?a("div",{staticClass:"container"},[a("drawComponent",{ref:"draw",attrs:{model:"view"}}),a("view-page",{attrs:{model:"view",reportName:t.reportName,panelShow:t.panelShow},on:{"update:panelShow":function(e){t.panelShow=e},"update:panel-show":function(e){t.panelShow=e}}})],1):t._e(),a("modal",{attrs:{properties:t.popupWindowOpt},on:{afterClickButton:t.changePopupWindowClick}},[a("div",{style:{width:"100%",height:"100%"},attrs:{slot:"windowBody"},slot:"windowBody"},[a("iframe",{style:{width:"100%",height:"100%"},attrs:{src:t.modalClick.iframeSrc,frameborder:"0"}})])])],1)}),[],!1,null,"f9d029ce",null);e.default=o.exports},"4c64":function(t,e,a){"use strict";var i=a("f968").a,n=(a("5be5"),a("2877")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("modal",{attrs:{properties:t.windowOpt},on:{afterClickButton:t.selectParam}},[a("div",{staticClass:"paramSelectWindow",attrs:{slot:"windowBody"},slot:"windowBody"},t._l(t.showParamSetting,(function(e){return a("div",{key:e.key,staticClass:"singleParam"},[a("div",{staticClass:"paramTitle"},[a("span",{staticClass:"paramName"},[t._v(t._s(t.paramName[e.key]))]),a("span",{staticClass:"paramValue"},[t._v(" "+t._s(t.selectedValue[e.key].realDate)+" ")])]),a("div",{staticClass:"TimeParam",attrs:{id:e.key+"ParamSetting"}},[a("my97DatePicker",{attrs:{properties:t.dataPickerOpt[e.key]},on:{onpicked:function(a){return t.selectValue(a,e)},ychanged:function(a){return t.ychanged(a,e)},Mchanged:function(a){return t.ychanged(a,e)}}})],1)])})),0)])}),[],!1,null,null,null);e.a=o.exports},5155:function(t,e,a){"use strict";a("4160"),a("159b");var i=a("5530"),n={name:"drawThumbnail",props:["model","option"],components:{},data:function(){var t={draging:!1,redraw:!0,transformDeltaAttr:null,length:0,x:0,y:0,startPos:{clientX:0,clientY:0},startX:0,startY:0};return Object(i.a)({isInit:!1,ratio:window.devicePixelRatio||1,highlightArr:[]},t)},computed:{selectSpanStyle:function(){var t=this.canvasW/this.option.width,e=this.canvasH/this.option.height,a=this._.min([t*this.option.spanWidth,this.canvasW]),i=this._.min([e*this.option.spanHeight,this.canvasH]);return{transform:"translate("+this.option.marginLeft*t+"px, "+this.option.marginTop*e+"px)",width:a+"px",height:i+"px"}}},watch:{option:function(){this.isInit&&(this.renderInit(),this.drawThumbnail())}},methods:{setCanvasRef:function(){this.$canvas=this.$refs.canvasRef,this.canvasContext=this.$refs.canvasRef&&this.$refs.canvasRef.getContext("2d")},drawThumbnail:function(){var t=this,e=this.option.currentList,a=this.ratio;this.$canvas.width=this.canvasW*a,this.$canvas.style.width=this.canvasW+"px",this.$canvas.height=this.canvasH*a,this.$canvas.style.height=this.canvasH+"px";var i=this.$canvas.getContext("2d");i.scale(a,a),i.lineWidth=1,i.fillStyle="rgba(0, 0, 0, 0.8)",i.fillRect(0,0,this.canvasW,this.canvasH);var n=60*this.canvasScale,o=this.option.pageConfig,s=o.width,r=o.height;i.strokeStyle="rgba(0, 186, 255, 0.5)",i.strokeRect(n,n,s*this.canvasScale,r*this.canvasScale),this._.forIn(e,(function(e){var a=e.position,n=parseFloat(a.width),o=parseFloat(a.height),s=parseFloat(a.left),r=parseFloat(a.top),l=(s+60)*t.canvasScale,c=(r+60)*t.canvasScale,h=n*t.canvasScale,d=o*t.canvasScale;i.fillStyle="rgba(255, 255, 255, 0.5)",i.fillRect(l,c,h,d),i.stroke()})),this.redraw=!1},calOffsetPosition:function(t,e,a){var i=t.clientX,n=t.clientY,o=this.$refs.spanRef.getBoundingClientRect(),s=o.width,r=o.height,l=e+i-this.startPos.clientX,c=a+n-this.startPos.clientY;return{x:l>=0&&l<=this.canvasW-s?l:l<0?0:this.canvasW-s,y:c>=0&&c<=this.canvasH-r?c:c<0?0:this.canvasH-r}},onDown:function(t){var e=this.$refs.divRef.getBoundingClientRect();this.x=e.x,this.y=e.y;var a=this.option.canvasWidth,i=this.option.canvasHeight;if(!this.draging){var n=t.clientX,o=t.clientY;this.startPos={clientX:n,clientY:o};var s=this.$refs.spanRef.getBoundingClientRect(),r=s.width,l=s.height,c=n-this.x-r/2,h=o-this.y-l/2,d=c>=0&&c<=this.canvasW-r?c:c<=0?0:this.canvasW-r,p=h>=0&&h<=this.canvasH-l?h:h<=0?0:this.canvasH-l;this.startX=d,this.startY=p,a>i?this.$emit("changePosition",d,p,this.canvasW/this.option.width):this.$emit("changePosition",d,p,this.canvasH/this.option.height)}},handleDown:function(t){var e=t.clientX,a=t.clientY,i=this.option.marginLeft,n=this.option.marginTop,o=this.option.width;this.startPos={clientX:e,clientY:a},this.startX=i*this.canvasW/o,this.startY=n*this.canvasW/o,this.draging=!0},handleMove:function(t){t.stopPropagation();var e=this.option.canvasWidth,a=this.option.canvasHeight;if(this.draging){var i=this.calOffsetPosition(t,this.startX,this.startY),n=i.x,o=i.y;e>a?this.$emit("changePosition",n,o,this.canvasW/this.option.width):this.$emit("changePosition",n,o,this.canvasH/this.option.height)}},handleUp:function(t){if(t.stopPropagation(),this.draging){this.draging=!1;var e=this.calOffsetPosition(t,this.startX,this.startY),a=e.x,i=e.y;this.startX=a,this.startY=i}},getPosition:function(t){var e=this.transformDeltaAttr,a=0,i=0;return e?(a=(t.x+60+e.x)*this.canvasScale,i=(t.y+60+e.y)*this.canvasScale):(a=(t.x+60)*this.canvasScale,i=(t.y+60)*this.canvasScale),{x:a,y:i,w:t.w*this.canvasScale,h:t.h*this.canvasScale,deg:0}},renderInit:function(){var t=this,e=this.option.canvasWidth,a=this.option.canvasHeight;e>=a?(this.canvasScale=190/e,this.canvasW=190,this.canvasH=110):(this.canvasScale=190/a,this.canvasW=110,this.canvasH=190),this.highlightArr=[],this._.forEach(this.option.selected,(function(e){var a=t.option.currentList[e].position,i=parseFloat(a.width),n=parseFloat(a.height),o=parseFloat(a.left),s=parseFloat(a.top);t.highlightArr.push(t.getPosition({x:o,y:s,w:i,h:n}))}))}},mounted:function(){var t=this;this.$nextTick((function(){t.setCanvasRef(),t.isInit=!0,window.addEventListener("mousemove",t.handleMove,!1),window.addEventListener("mouseup",t.handleUp,!1)}))}},o=(a("c77c"),a("2877")),s=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"divRef",staticClass:"draw-thumbnail",on:{mousedown:function(e){return e.stopPropagation(),t.onDown(e)}}},[a("canvas",{ref:"canvasRef",staticClass:"canvas-thumbnail"}),t._l(t.highlightArr,(function(t,e){return a("span",{key:e,staticClass:"highlight",style:{transform:"translate("+t.x+"px, "+t.y+"px) rotate("+t.deg+"deg)",width:t.w+"px",height:t.h+"px"}})})),a("span",{ref:"spanRef",staticClass:"select-span",style:t.selectSpanStyle,on:{mousedown:function(e){return e.stopPropagation(),t.handleDown(e)}}})],2)}),[],!1,null,"5560e420",null);e.a=s.exports},5579:function(t,e,a){"use strict";var i=a("123a");a.n(i).a},"5be5":function(t,e,a){"use strict";var i=a("fa14");a.n(i).a},"6ad0":function(t,e,a){"use strict";var i=a("8e05");a.n(i).a},"78fa":function(t,e,a){"use strict";var i=a("5530"),n=a("2f62"),o={name:"viewSwitch",data:function(){return{showType:"all"}},methods:{bindSwitch:function(){this.$emit("changeShowType",this.showType),this.showType="page"===this.showType?"all":"page"}}},s=(a("3631"),a("2877")),r=Object(s.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"toggle-button-wrapper"},[a("input",{attrs:{type:"checkbox",id:"toggle-button",name:"switch"}}),a("label",{staticClass:"button-label",attrs:{for:"toggle-button"},on:{click:t.bindSwitch}},[a("span",{staticClass:"circle"}),a("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("design.viewAllShow"),expression:"$t('design.viewAllShow')",modifiers:{bottom:!0}}],staticClass:"text on"},[t._v(t._s(t.$t("design.viewAllShow")))]),a("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("design.viewPageShow"),expression:"$t('design.viewPageShow')",modifiers:{bottom:!0}}],staticClass:"text off"},[t._v(t._s(t.$t("design.viewPageShow")))])])])}),[],!1,null,"7d9f6305",null).exports,l=a("c0e9"),c=a.n(l),h=a("e511"),d=a.n(h),p={name:"viewPage",components:{viewSwitch:r},props:["model","reportName","panelShow"],data:function(){return{editPage:"",showType:"page",firstOpen:!1,errorText:"",showSpread:!0,currentIndex:0,showDropDowmFlag:!1,fullScreen:!1}},directives:{focus:function(t){t.focus()}},computed:Object(i.a)({},Object(n.d)({lastAddPage:function(t){return t.draw.lastAddPage},drawSize:function(t){return t.draw.drawSize},currentPage:function(t){return t.draw.currentPage},pageList:function(t){return t.pageController.pageList},pageNameList:function(t){return t.pageController.pageNameList},drawPanels:function(t){return t.draw.drawPanels},pageContent:function(t){return t.draw.pageContent}})),watch:{lastAddPage:function(){this.lastAddPage&&(this.emptyError(),this.controllerAddPage(this.lastAddPage))},pageList:function(){this.firstOpen?(this.firstOpen=!1,this.editId||"view"===this.model?this.drawChangeCurrentPage(this.pageList[0]):this.drawAddPage()):0===this.pageList.length&&this.drawAddPage()},currentPage:function(){for(var t=0;t<this.pageList.length;t++)this.currentPage===this.pageList[t]&&(this.currentIndex=t+1)}},methods:Object(i.a)(Object(i.a)({},Object(n.b)({drawChangeCurrentPage:"drawChangeCurrentPage",drawChangeBlockLoadingState:"drawChangeBlockLoadingState",drawAddPage:"drawAddPage",drawDeletePage:"drawDeletePage",controllerAddPage:"controllerAddPage",controllerDeletePage:"controllerDeletePage",controllerChangePageName:"controllerChangePageName",controllerMovePage:"controllerMovePage",changelogoValue:"changelogoValue"})),{},{emptyError:function(){this.errorText=""},lisetningSwitch:function(t){this.showType=t},showDropDowm:function(){this.showDropDowmFlag=!this.showDropDowmFlag},drawFullScreen:function(){var t=document.documentElement;t=t||document.body,this.fullScreen=!0,t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen()},drawShrinkScreen:function(){this.fullScreen=!1,document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()},drawDownloadReport:function(){var t=this;this.drawChangeBlockLoadingState({name:"view",loadState:"start"});var e=new d.a(parseFloat(this.drawSize.width)>parseFloat(this.drawSize.height)?"l":"p","pt",[3*parseFloat(this.drawSize.width)/4,3*parseFloat(this.drawSize.height)/4]);this.changelogoValue(!0),setTimeout((function(){t.htmlToPdf(e,t.reportName,0)}),2)},htmlToPdf:function(t,e,a){var i=this,n=null,o=(n=i.drawPanels.length?i.drawPanels[a]:i.drawPanels).offsetWidth,s=n.offsetHeight,r=document.createElement("canvas");r.width=o,r.height=s,r.getContext("2d").scale(2,2),c()(n,{scale:2,useCORS:!0,dpi:window.devicePixelRatio,allowTaint:!1,taintTest:!1}).then((function(n){var o=n.getContext("2d");o.mozImageSmoothingEnabled=!1,o.webkitImageSmoothingEnabled=!1,o.msImageSmoothingEnabled=!1,o.imageSmoothingEnabled=!1;var s=n.width,r=n.height,l=i._.ceil(s/(3*parseFloat(i.drawSize.width)/4)*(3*parseFloat(i.drawSize.height)/4)),c=r,h=0,d=3*parseFloat(i.drawSize.width)/4,p=d/s*r,u=n.toDataURL("image/jpeg",1);if(t.internal.scaleFactor=1.33,c<l)t.addImage(u,"jpeg",0,0,d,p);else for(;c>0;)t.addImage(u,"jpeg",0,h,d,p),c-=l,h-=3*parseFloat(i.drawSize.height)/4,c>0&&t.addPage();i.drawPanels.length!==a+1&&i.drawPanels.length?(t.addPage([3*parseFloat(i.drawSize.width)/4,3*parseFloat(i.drawSize.height)/4],parseFloat(i.drawSize.width)>parseFloat(i.drawSize.height)?"l":"p"),i.htmlToPdf(t,e,a+1)):(i.drawChangeBlockLoadingState({name:"view",loadState:"finish"}),t.save("".concat(e,".pdf")),setTimeout((function(){i.changelogoValue(!1)}),2))}))},changeShowType:function(t){this.emptyError(),this.showType=t,"all"===t?this.drawChangeCurrentPage("all"):this.drawChangeCurrentPage(this.pageList[0])},clickPage:function(t){this.emptyError();var e=this;if(this.showDropDowmFlag=!1,!this.editPage&&"page"===this.showType){if("left"===t||"right"===t)for(var a=0;a<this.pageList.length;a++)this.currentPage===this.pageList[a]&&("left"===t?t=0===a?this.pageList[a]:this.pageList[a-1]:"right"===t&&(t=a===this.pageList.length-1?this.pageList[a]:this.pageList[a+1]));clearTimeout(this.clickSetTime),this.clickSetTime=setTimeout((function(){e.drawChangeCurrentPage(t)}),300)}}}),mounted:function(){var t=this;this.$nextTick((function(){window.parent.parent&&window.parent.parent.report_data&&(window.addEventListener("message",(function(e){"export"===e.data&&t.drawDownloadReport()})),this.changeShowType("all"),this.showSpread=!1)})),"edit"!==this.model||this.editId?this.pageList.length>0?this.drawChangeCurrentPage(this.pageList[0]):this.firstOpen=!0:this.drawAddPage()}},u=(a("fa44"),Object(s.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.panelShow,expression:"panelShow"}],staticClass:"view-page-wrapper",attrs:{onselectstart:"return false;"}},[a("div",{staticClass:"float-left"},["page"===t.showType?[a("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("design.viewLeft"),expression:"$t('design.viewLeft')",modifiers:{bottom:!0}}],staticClass:"iconfont icon-arrow-left",class:{ends:1===t.currentIndex},on:{click:function(e){return t.clickPage("left")}}}),a("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("design.viewRight"),expression:"$t('design.viewRight')",modifiers:{bottom:!0}}],staticClass:"iconfont icon-arrow-right",class:{ends:t.currentIndex===t.pageList.length},on:{click:function(e){return t.clickPage("right")}}}),a("span",{staticClass:"line"}),a("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.pageNameList[t.currentPage],expression:"pageNameList[currentPage]",modifiers:{bottom:!0}}]},[t._v(" "+t._s(t.pageNameList[t.currentPage])+" ")]),a("span",[t._v(" ( "+t._s(t.$t("design.viewDI"))+" "+t._s(t.currentIndex)+" "+t._s(t.$t("design.viewDPage"))+" , "+t._s(t.$t("design.viewGONG"))+" "+t._s(t.pageList.length)+" "+t._s(t.$t("design.viewGPage"))+" ) ")]),a("span",{staticClass:"iconfont more icon-showdrop drop-dowm",on:{click:function(e){return e.preventDefault(),t.showDropDowm()}}},[a("ul",{directives:[{name:"show",rawName:"v-show",value:t.showDropDowmFlag,expression:"showDropDowmFlag"}],staticClass:"ul-list",on:{mouseleave:function(e){return e.preventDefault(),t.showDropDowm()}}},t._l(t.pageList,(function(e,i){return a("li",{key:i,class:{active:i===t.currentIndex-1},on:{click:function(a){return a.preventDefault(),t.clickPage(e)}}},[t._v(" "+t._s(i+1)+" . "+t._s(t.pageNameList[e])+" ")])})),0)]),a("span",{staticClass:"line"})]:t._e(),a("span",[a("view-switch",{on:{changeShowType:t.changeShowType,click:function(e){return t.changeShowType()}}})],1)],2),a("div",{staticClass:"float-right"},[a("span",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("design.drawDownloadReport"),expression:"$t('design.drawDownloadReport')",modifiers:{bottom:!0}}],staticClass:"iconfont icon-bottom downReport",on:{click:function(e){return t.drawDownloadReport()}}}),a("span",{staticClass:"line"}),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.fullScreen,expression:"!fullScreen"},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("design.drawPcFullScreen"),expression:"$t('design.drawPcFullScreen')",modifiers:{bottom:!0}}],staticClass:"iconfont icon-enlarge full",on:{click:function(e){return t.drawFullScreen()}}}),a("span",{directives:[{name:"show",rawName:"v-show",value:t.fullScreen,expression:"fullScreen"},{name:"tooltip",rawName:"v-tooltip.bottom",value:t.$t("design.drawPcShrinkScreen"),expression:"$t('design.drawPcShrinkScreen')",modifiers:{bottom:!0}}],staticClass:"iconfont icon-narrow shrink",on:{click:function(e){return t.drawShrinkScreen()}}})])])])}),[],!1,null,"1a21cadb",null));e.a=u.exports},"8e05":function(t,e,a){},"9ad6":function(t,e,a){"use strict";a("99af"),a("a434");var i={name:"canvasRuler",props:["option"],components:{},data:function(){return{$canvas:null,canvasContext:null,isInit:!1}},computed:{},watch:{option:function(){this.isInit&&(this.updateCanvasContext(),this.drawRuler())}},methods:{setCanvasRef:function(){this.$canvas=this.$refs.canvasRef,this.canvasContext=this.$refs.canvasRef&&this.$refs.canvasRef.getContext("2d")},updateCanvasContext:function(){var t=this.option.width,e=this.option.height,a=this.option.canvasConfigs,i=a.ratio,n=a.fgColor;this.$canvas.width=t*i,this.$canvas.style.width=t+"px",this.$canvas.height=e*i,this.$canvas.style.height=e+"px";var o=this.$canvas.getContext("2d");o.font="12px Microsoft YaHei, PingFangSC-Regular, Arial, sans-serif",o.lineWidth=1,o.fillStyle="#5F6367",o.strokeStyle=n,o.textBaseline="middle"},drawRuler:function(){var t=this.option.scale,e=(this.option.vertical,this.option.width),a=this.option.height,i=this.option.start,n={scale:t,width:e,height:a,canvasConfigs:this.option.canvasConfigs};this.drawCanvasRuler(this.canvasContext,i,n)},drawCanvasRuler:function(t,e,a){var i=a.scale,n=a.width,o=a.height,s=a.canvasConfigs,r=s.bgColor,l=s.fontColor,c=s.ratio;0!==i&&(t.scale(c,c),t.fillRect(0,0,n,o),t.fillStyle=r,t.fillRect(0,0,n,o),t.beginPath(),t.font="10px Microsoft YaHei",t.fillStyle=l,this.canvasColumn(t,n,o,1/i),t.stroke(),t.closePath(),t.setTransform(1,0,0,1,0,0))},getValueByOffset:function(t){return Math.round(this.option.start+(t.offsetX-40)/this.option.scale)},handleClick:function(t){this.$emit("addline",this.getValueByOffset(t))},handleEnter:function(t){this.$emit("indicatorshow",this.getValueByOffset(t))},handleMove:function(t){this.$emit("indicatormove",this.getValueByOffset(t))},handleLeave:function(){this.$emit("indicatorhide")},canvasColumn:function(t,e,a,i){for(var n=Math.abs,o=0,s="",r=!1,l=0,c=0,h=this.canvasM(i,8),d=0;d<i*e;d+=h)if(r=!1,s="",c=(l=d)/i+40,0==l%(10*h*2)?(o=0,s=n(l),r=!0):0==l%(10*h)?(o=a-6,s=n(l),r=!0):0==l%h&&(o=a-3,r=!0),r){var p=.5;t.moveTo(c+p,a+p),t.lineTo(c+p,o+p),t.fillText(s,c+2.5,a/2)}},canvasM:function(t,e){for(var a=0;!((a+=10)/t>e););if(10>=a){for(a=0;!((a+=2)/t>e););return Math.max(1,a-2)}return a-10}},mounted:function(){var t=this;this.$nextTick((function(){t.setCanvasRef(),t.isInit=!0}))}},n=a("2877"),o=Object(n.a)(i,(function(){var t=this.$createElement;return(this._self._c||t)("canvas",{ref:"canvasRef",staticClass:"canvas-ruler",on:{click:this.handleClick,mouseenter:this.handleEnter,mousemove:this.handleMove,mouseleave:this.handleLeave,mousedown:function(t){t.stopPropagation()}}})}),[],!1,null,"33e7c4c6",null).exports,s=a("ade3"),r={name:"rulerLine",props:["option"],components:{},data:function(){return{}},computed:{rulerLineStyle:function(){return Object(s.a)({},this.option.vertical?"top":"left","".concat((this.option.value-this.option.start)*this.option.scale+40,"px"))}},watch:{},methods:{handleDown:function(t){var e=this,a=this.option.vertical,i=this.option.value,n=this.option.scale,o=this.option.index,s=a?t.clientY:t.clientX;this.$emit("mousedown");var r=function(t){var r=a?t.clientY:t.clientX,l=Math.round(i+(r-s)/n);e.$emit("change",l,o)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",(function t(l){var c=a?l.clientY:l.clientX,h=Math.round(i+(c-s)/n);e.$emit("release",h,o),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",t)}))},handleRemove:function(){this.$emit("remove",this.option.index)}},mounted:function(){}},l=(a("caeb"),{name:"drawRuler",props:["option"],components:{canvasRuler:o,rulerLine:Object(n.a)(r,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ruler-line ",style:t.rulerLineStyle,attrs:{title:"双击删除参考线"},on:{mousedown:function(e){return e.stopPropagation(),t.handleDown(e)},dblclick:t.handleRemove}},[a("div",{staticClass:"line-action"},[a("span",{staticClass:"line-value"},[t._v(t._s(t.option.value))])])])}),[],!1,null,"f4c1b8d0",null).exports},data:function(){return{isDraggingLine:!1,showIndicator:!1,value:0}},computed:{rulerWrapperStyle:function(){return{transform:this.option.vertical?"rotate(90deg) translateX(-".concat(this.option.marginTop,"px)"):"translateX(-".concat(this.option.marginLeft,"px)")}},canvasStyle:function(){return{vertical:this.option.vertical,width:this.option.width,height:this.option.height,scale:this.option.scale,start:this.option.start,canvasConfigs:this.option.canvasConfigs}},indicatorStyle:function(){return{left:"".concat((this.value-this.option.start)*this.option.scale+40,"px")}}},watch:{},methods:{handleIndicatorShow:function(t){this.isDraggingLine||(this.showIndicator=!0,this.value=t)},handleIndicatorMove:function(t){this.showIndicator&&(this.value=t)},handleIndicatorHide:function(){this.showIndicator=!1},handleNewLine:function(t){var e=this.option.lines,a=this.option.vertical;e.push(t),this.$emit("linechange",e,a,!0)},handleLineChange:function(t,e){var a=this.option.lines,i=this.option.vertical;a[e]=t,this.$emit("linechange",a,i,!0)},handleLineRemove:function(t){var e=this.option.lines,a=this.option.vertical;e.splice(t,1),this.$emit("linechange",e,a,!0)},handleLineDown:function(){this.isDraggingLine=!0},handleLineRelease:function(){this.isDraggingLine=!1}},mounted:function(){}}),c=(a("5579"),Object(n.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ruler-wrapper",class:[t.option.vertical?"v-container":"h-container"],style:t.rulerWrapperStyle},[a("canvas-ruler",{attrs:{option:t.canvasStyle},on:{addline:t.handleNewLine,indicatorshow:t.handleIndicatorShow,indicatormove:t.handleIndicatorMove,indicatorhide:t.handleIndicatorHide}}),a("div",{staticClass:"lines-wrapper"},t._l(t.option.lines,(function(e,i){return a("ruler-line",{key:i,attrs:{option:{isShow:t.option.isShow,index:i,value:e,scale:t.option.scale,start:t.option.start,vertical:t.option.vertical}},on:{change:t.handleLineChange,remove:t.handleLineRemove,mousedown:t.handleLineDown,release:t.handleLineRelease}})})),1),t.showIndicator?a("div",{staticClass:"indicator",style:t.indicatorStyle},[a("span",{staticClass:"value"},[t._v(t._s(t.value))])]):t._e()],1)}),[],!1,null,"a60d502e",null).exports),h=a("006f"),d={name:"drawRuler",props:["model","option"],components:{ruler:c},data:function(){return{canvasConfigs:{bgColor:Object(h.b)("ruleBg"),fgColor:Object(h.b)("ruleFg"),fontColor:Object(h.b)("ruleFont"),ratio:window.devicePixelRatio||1}}},computed:{canvasRuler:function(){return{height:this.option.thick,start:this.option.start,isShow:this.option.isShow,scale:this.option.scale,canvasConfigs:this.canvasConfigs}}},watch:{},methods:{handleLineChange:function(t,e,a){var i=this.option.horLineArr,n=this.option.verLineArr,o=e?{h:i,v:this._.concat(t)}:{h:this._.concat(t),v:n};this.$emit("handleline",o)}},mounted:function(){}},p=(a("9f19"),Object(n.a)(d,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"draw-ruler"},[a("ruler",{attrs:{option:Object.assign({},{marginLeft:t.option.marginLeft,width:t.option.width,vertical:!1,lines:t.option.horLineArr},t.canvasRuler)},on:{linechange:t.handleLineChange,draglinestart:function(t){},draglineend:function(t){}}}),a("ruler",{attrs:{option:Object.assign({},{marginTop:t.option.marginTop,width:t.option.height,vertical:!0,lines:t.option.verLineArr},t.canvasRuler)},on:{linechange:t.handleLineChange}}),t._m(0)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"corner",attrs:{title:"toggle Guide lines"}},[e("i",{staticClass:"datav-icon datav-font icon-line-show",staticStyle:{"z-index":"10"}})])}],!1,null,"1c941d19",null));e.a=p.exports},"9f19":function(t,e,a){"use strict";var i=a("b3bb");a.n(i).a},aca7:function(t,e,a){t.exports=a.p+"img/logo.0b8406e1.jpg"},b3bb:function(t,e,a){},baa7:function(t,e,a){"use strict";var i=a("1573").a,n=(a("6ad0"),a("2877")),o=Object(n.a)(i,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loadingLinear",rawName:"v-loadingLinear",value:{show:t.loadingState},expression:"{ show: loadingState }"}],staticClass:"design-panel-wrap",style:t.padStyle,on:{mousedown:function(e){return t.mousedown(e)},mousemove:function(e){return t.mousemove(e)},mouseup:function(e){return t.mouseup(e)},mouseleave:function(e){return t.mouseleave(e)},contextmenu:function(t){t.preventDefault()},selectstart:function(t){t.preventDefault()}}},[i("div",{staticClass:"pagebox",style:t.pageBoxStyle},["edit"===t.model?i("draw-ruler",{attrs:{option:{width:t.pageBoxStyle.width&&parseFloat(t.pageBoxStyle.width),height:t.pageBoxStyle.height&&parseFloat(t.pageBoxStyle.height),start:0,thick:20,marginTop:t.drawEventData.marginTop,marginLeft:t.drawEventData.marginLeft,scale:t.drawEventData.scale,horLineArr:this.lines.h,verLineArr:this.lines.v}},on:{handleline:t.handleLine}}):t._e(),t._l(t.pageList,(function(e,n){return[e===t.currentPage||"all"===t.currentPage||"view"===t.model&&t.reportSetting.showDirection?i("div",{key:"draw-"+e,staticClass:"page",class:{overHide:"view"===t.model,boxShadow:t.reportSetting.showPadding},style:t.transformPageStyle[e],attrs:{editRole:e}},[i("div",{ref:"drawPanel",refInFor:!0,staticClass:"graticule",class:{graticuleLine:"edit"===t.model},style:t.transformGraticuleStyle[e]},[t._l(t.drawBlockContent[e],(function(e){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.showBolckArea(e),expression:"showBolckArea(item)"}],key:e.id,staticClass:"bolckArea",class:{selected:e.selected},style:e.position,attrs:{editRole:"bolck",name:e.id}},[i("div",{key:"draw-"+e.id,staticClass:"blockContent",attrs:{editRole:"content"}},[i(t.comName(e),{tag:"component",attrs:{blockType:e.type,model:t.model,getData:e.contentData,getStyle:e.position,blockId:e.id,reportSetting:t.reportStyle.blockStyle,theme:t.reportSetting.echartsTheme,toggleData:t.dataForToggleType[e.id],params:t.paramToBlock}})],1),"edit"===t.model&&"text"!==e.type?i("div",{staticClass:"block-content-mask"}):t._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:e.selected,expression:"item.selected"}],staticClass:"selectBorder"},[i("div",{staticClass:"borderTop"}),i("div",{staticClass:"borderBottom"}),i("div",{staticClass:"borderLeft"}),i("div",{staticClass:"borderRight"})]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.selected&&1===t.selected.length,expression:"item.selected && selected.length === 1"}],staticClass:"border",attrs:{editRole:"border"}},[i("div",{staticClass:"leftTop",attrs:{editRole:"leftTop"}}),i("div",{staticClass:"leftCenter",attrs:{editRole:"leftCenter"}}),i("div",{staticClass:"leftBottom",attrs:{editRole:"leftBottom"}}),i("div",{staticClass:"rightTop",attrs:{editRole:"rightTop"}}),i("div",{staticClass:"rightCenter",attrs:{editRole:"rightCenter"}}),i("div",{staticClass:"rightBottom",attrs:{editRole:"rightBottom"}}),i("div",{staticClass:"topCenter",attrs:{editRole:"topCenter"}}),i("div",{staticClass:"bottomCenter",attrs:{editRole:"bottomCenter"}})])])})),i("div",{directives:[{name:"show",rawName:"v-show",value:t.resizerData.show,expression:"resizerData.show"}],staticClass:"resizer",style:t.resizerData.style},[i("div",{staticClass:"selectBorder"},[i("div",{staticClass:"borderGroup",style:t.resizerData.styleTop}),i("div",{staticClass:"borderGroup",style:t.resizerData.styleBottom}),i("div",{staticClass:"borderGroup",style:t.resizerData.styleLeft}),i("div",{staticClass:"borderGroup",style:t.resizerData.styleRight})]),i("div",{staticClass:"border",attrs:{editRole:"border"}},[i("div",{staticClass:"leftTop",attrs:{editRole:"leftTop"}}),i("div",{staticClass:"leftCenter",style:t.resizerData.leftCenter,attrs:{editRole:"leftCenter"}}),i("div",{staticClass:"leftBottom",style:t.resizerData.leftBottom,attrs:{editRole:"leftBottom"}}),i("div",{staticClass:"rightTop",style:t.resizerData.rightTop,attrs:{editRole:"rightTop"}}),i("div",{staticClass:"rightCenter",style:t.resizerData.rightCenter,attrs:{editRole:"rightCenter"}}),i("div",{staticClass:"rightBottom",style:t.resizerData.rightBottom,attrs:{editRole:"rightBottom"}}),i("div",{staticClass:"topCenter",style:t.resizerData.topCenter,attrs:{editRole:"topCenter"}}),i("div",{staticClass:"bottomCenter",style:t.resizerData.bottomCenter,attrs:{editRole:"bottomCenter"}})])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.reportStyle.pageNum.show,expression:"reportStyle.pageNum.show"}],staticClass:"pageNum",class:[t.reportStyle.pageNum.position]},[t._v(t._s(n+1))]),i("img",{directives:[{name:"show",rawName:"v-show",value:"view"===t.model&&t.showLogo,expression:"model === 'view' && showLogo"}],staticClass:"logoImage",attrs:{src:a("aca7"),alt:"数据股份图标"}}),t.showReportParam&&(e===t.currentPage||"all"===t.currentPage&&0===n)?i("div",{staticClass:"reportParam",class:[t.paramStyleSetting.position,"view"===t.model?"pointer":""],on:{click:t.clickParamButton}},[i("span",{staticClass:"iconfont icon-report-param"})]):t._e()],2)]):t._e()]}))],2),i("div",{directives:[{name:"show",rawName:"v-show",value:"select"===t.drawEventData.mouseState||"create"===t.drawEventData.mouseState,expression:"drawEventData.mouseState === 'select' || drawEventData.mouseState === 'create'"}],staticClass:"auxiliaryFrame",style:t.auxiliaryFrameStyle}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.contextMenu.show,expression:"contextMenu.show"}],staticClass:"contextMenu",style:t.contextMenu.style,attrs:{id:"contextMenu"},on:{mousedown:function(t){t.stopPropagation()},mouseup:function(t){t.stopPropagation()}}},[i("ul",{staticClass:"menuBox",staticStyle:{padding:"0",margin:"0"}},t._l(t.contextMenu.data,(function(e){return i("li",{directives:[{name:"show",rawName:"v-show",value:t.contextMenuShow[e.value],expression:"contextMenuShow[menu.value]"}],key:e.value,staticClass:"menuList",style:{height:t.defaultData.contextmenuLineHeight+"px"},on:{click:function(a){return a.stopPropagation(),t.clickMenu(e.value)}}},[i("div",{staticClass:"menuText",class:{spread:e.children}},[t._v(t._s(e.text))]),e.children?i("ul",{staticClass:"subMenuBox",class:{subleft:"left"===t.contextMenu.subX,subright:"right"===t.contextMenu.subX,subtop:"top"===t.contextMenu.subY,subbottom:"bottom"===t.contextMenu.subY},style:e.children.style},t._l(e.children.data,(function(e){return i("li",{key:e.value,staticClass:"subMenuList",style:{height:t.defaultData.contextmenuLineHeight+"px"},on:{click:function(a){return a.stopPropagation(),t.clickMenu(e.value)}}},[i("div",{staticClass:"subMenuText"},[t._v(t._s(e.text))])])})),0):t._e()])})),0)]),"view"===t.model?i("paramWindow",{attrs:{show:t.showParamWindow,showParamSetting:t.paramSettingWithKey,paramValue:t.paramCurrentValue},on:{selectParam:t.selectParam}}):t._e(),"edit"===t.model?i("div",{staticClass:"thumbnail thumbnail-show",class:{"thumbnail-show":t.showThumbnail,"thumbnail-hide":!t.showThumbnail},style:{right:t.showRight?"303px":"25px"}},[i("drawThumbnail",{attrs:{option:{selected:t.selected,currentList:t.drawBlockContent[t.currentPage],marginTop:t.drawEventData.marginTop,marginLeft:t.drawEventData.marginLeft,scale:t.drawEventData.scale,canvasWidth:t.drawEventData.pageWidth+350,canvasHeight:t.drawEventData.pageHeight+350-60-30,width:t.pageBoxStyle.width&&parseFloat(t.pageBoxStyle.width),height:t.pageBoxStyle.height&&parseFloat(t.pageBoxStyle.height),spanWidth:t.parentWidth,spanHeight:t.parentHeight,pageConfig:{width:t.drawEventData.pageWidth,height:t.drawEventData.pageHeight}}},on:{changePosition:t.changeScrollPosition}})],1):t._e(),"edit"===t.model?i("div",{staticClass:"panel-control"},[i("span",{staticClass:"number-tip"},[t._v(t._s(t.drawScalePercentage))]),i("span",{staticClass:"number-tip jian",on:{click:function(e){return t.scaleClick(0)}}},[t._v("-")]),i("div",{staticClass:"scroll",attrs:{id:"scrollBar"}},[i("div",{staticClass:"bar",on:{mousedown:function(e){return e.stopPropagation(),t.scaleMounsedown(e)}}}),i("div",{staticClass:"mask"})]),i("span",{staticClass:"number-tip add",on:{click:function(e){return t.scaleClick(1)}}},[t._v("+")])]):t._e()],1)}),[],!1,null,"70bc5160",null);e.a=o.exports},c77c:function(t,e,a){"use strict";var i=a("eb9b");a.n(i).a},c834:function(t,e,a){},caeb:function(t,e,a){"use strict";var i=a("cc44");a.n(i).a},cc44:function(t,e,a){},dc3d:function(t,e,a){"use strict";var i=a("c834");a.n(i).a},e483:function(t,e,a){"use strict";(function(t,i){var n=a("b85c"),o=a("5530"),s=a("baa7"),r=a("5a0c"),l=a.n(r),c=a("78fa"),h=a("2f62");e.a={name:"view-screen",metaInfo:function(){return{title:this.reportName,titleTemplate:"%s › "+this.$store.state.pageController.pageNameList[this.$store.state.draw.currentPage]}},data:function(){return{timer:null,isMove:!1,showAll:!1,reportName:"",modelId:"",panelShow:!1,urls:{openReport:"/report"}}},components:{drawComponent:s.a,viewPage:c.a},computed:Object(o.a)(Object(o.a)({},Object(h.d)({popupWindowOpt:function(t){return t.popupWindowOpt},popupWindowClick:function(t){return t.popupWindowClick},dropDownOpt:function(t){return t.dropDownOpt},reportSetting:function(t){return t.draw.reportSetting},modalClick:function(t){return t.modalClick}})),Object(h.c)({paramSettingWithKey:"paramSettingWithKey",paramToBlock:"paramToBlock"})),watch:{popupWindowClick:function(){switch(this.popupWindowUser){case"initLoad":this.hidePopupWindow();break;case"authority":window.parent&&window.close(),this.hidePopupWindow()}},modalClick:function(){this.showPopupWindow(this.modalClick)},popupWindowOpt:function(){!this.popupWindowOpt.show&&this.popupWindowUser&&(this.popupWindowUser="")},paramSettingWithKey:function(){var t,e={},a=Object(n.a)(this.paramSettingWithKey);try{for(a.s();!(t=a.n()).done;){var i=t.value;e[i.key]=this.dateCalculate(i)}}catch(t){a.e(t)}finally{a.f()}this.changeReportParamDefaultValue(e)}},methods:Object(o.a)({mouseLeave:function(){this.panelShow=!1},mousemove:function(){var t=this;this.reportSetting.showDirection?this.panelShow=!1:(this.isMove=!0,this.panelShow=!0,clearTimeout(this.timer),this.timer=setTimeout((function(){this.isMove=!1,t.panelShow=!1}),5e3))},hideSomething:function(){this.dropDownOpt.isShow&&this.hideDropDown()},dateCalculate:function(e){var a="";switch(e.unit){case"year":a=e.defaultValue+" years ago";break;case"quarterly":a=3*e.defaultValue+" months ago";break;case"month":a=e.defaultValue+" months ago";break;case"week":a=e.defaultValue+" weeks ago";break;case"day":a=e.defaultValue+" days ago"}var i=t(a),n=this.$route.query[e.key],o="",s="",r=i.getFullYear(),l=i.getMonth()+1,c=i.getDate();switch(e.unit){case"year":o+=r,n&&(o=n.substr(0,4)),s+=r;break;case"quarterly":o=o+r+"-0"+Math.ceil(l/3),n&&(o=n.substr(0,4)+"-"+n.substring(4)),s=s+r+"0"+Math.ceil(l/3);break;case"month":o=o+r+"-"+(l<10?"0"+l:l),n&&(o=n.substr(0,4)+"-"+n.substring(4)),s+=this.dateFormat(i,e.unit,e.timeFormat);break;case"week":o=o+r+"-"+(l<10?"0"+l:l)+"-"+(c<10?"0"+c:c),n&&(o=this.convertWeekNumberToFirstDate(n.substr(0,4),n.substring(4))),s=s+r+this.getWeek(i);break;case"day":o=o+r+"-"+(l<10?"0"+l:l)+"-"+(c<10?"0"+c:c),n&&(o=n.substr(0,4)+"-"+n.substr(4,2)+"-"+n.substr(6,2)),s+=this.dateFormat(i,e.unit,e.timeFormat)}return n&&(s=n),{pickerDate:o,realDate:s}},convertWeekNumberToFirstDate:function(t,e,a){void 0===a&&(a=!0);var i=1,n=parseInt(t),o=parseInt(e),s=1,r=new Date(n,0,s);if(!a){if(!(i<o))return r;i++}return 1!==r.getDay()&&(s+=7-r.getDay()+1,r.setFullYear(n,0,s)),i<o&&(s+=7*(o-i),r.setFullYear(n,0,s)),l()(r).format("YYYY-MM-DD")},dateFormat:function(t,e,a){var i="",n=t.getFullYear(),o=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,s=t.getDate()<10?"0"+t.getDate():t.getDate();switch(a){case"YYYYMMDD":i=i+n+o,"day"===e&&(i+=s);break;case"YYYY-MM-DD":i=i+n+"-"+o,"day"===e&&(i=i+"-"+s);break;case"YYYY/MM/DD":i=i+n+"/"+o,"day"===e&&(i=i+"/"+s);break;case"MMDD,YYYY":i+=o,"day"===e&&(i+=s),i=i+","+n;break;case"MM-DD-YYYY":i+=o,"day"===e&&(i=i+"-"+s),i=i+"-"+n;break;case"MM/DD/YYYY":i+=o,"day"===e&&(i=i+"/"+s),i=i+"/"+n}return i},getWeek:function(t){var e=new Date(t.getFullYear(),0,1),a=Math.ceil(((t-e)/864e5+e.getDay()+1)/7);return a<10?"0"+a:a}},Object(h.b)({hideDropDown:"hideDropDown",changeDropDownSelected:"changeDropDownSelected",drawRestoreData:"drawRestoreData",drawChangeBlockLoadingState:"drawChangeBlockLoadingState",controllerRestoreData:"controllerRestoreData",showPopupWindow:"showPopupWindow",hidePopupWindow:"hidePopupWindow",changePopupWindowClick:"changePopupWindowClick",restoreReportParam:"restoreReportParam",changeReportParamDefaultValue:"changeReportParamDefaultValue",changeReportParamSelectValue:"changeReportParamSelectValue"})),mounted:function(){var t=this;if(this.showAll=!0,this.$route.params.id){this.modelId=this.$route.params.id;var e={resId:this.modelId,type:"view"};this.drawChangeBlockLoadingState({name:"view",loadState:"start"}),this.$http({url:this.urls.openReport,params:e,method:"get"}).then((function(e){if(i.isEmptyObject(e.data)){var a={show:!0,type:"alert",content:t.$t("design.designNoData")};t.popupWindowUser="initLoad",t.showPopupWindow(a)}else{e.data=e.data.data;var n=e.data.init_params.content;t.reportName=e.data.init_params.title,n.reportParam||(n.reportParam={}),n.reportParam.paramList=e.data.init_params.param?JSON.parse(e.data.init_params.param):[],t.restoreReportParam(n.reportParam),t.controllerRestoreData(n.pageController),t.drawRestoreData(n.draw)}t.drawChangeBlockLoadingState({name:"view",loadState:"finish"})})).catch((function(e){t.drawChangeBlockLoadingState({name:"view",loadState:"error"});var a=t.$t("design.designGetDataFailed");e&&e.response&&e.response.data&&(a=e.response.data.message);var i={show:!0,type:"alert",content:a,style:{height:"145px"}};t.popupWindowUser="initLoad",t.showPopupWindow(i)}))}else if(opener){var a=i.extend(!0,{},opener.publicVariable.preview.data);t.reportName=t.$t("design.designView")+" Model",a.reportParam.paramList=opener.publicVariable.preview.param?JSON.parse(opener.publicVariable.preview.param):[],this.restoreReportParam(a.reportParam),this.controllerRestoreData(a.pageController),this.drawRestoreData(a.draw)}}}}).call(this,a("1625"),a("1157"))},ea3d:function(t,e,a){},eb9b:function(t,e,a){},f968:function(t,e,a){"use strict";(function(t){a("caad");var i=a("b85c");e.a={name:"paramSelectWindow",props:["show","showParamSetting","paramValue"],data:function(){return{currentValue:{},paramName:{reportTime:"",beginTime:this.$t("design.paramWindowStartTime"),endTime:this.$t("design.paramWindowEndTime")},dataFmt:{day:"yyyy-MM-dd",week:"yyyy-MM-dd",month:"yyyy-MM",quarterly:"yyyy-MM",year:"yyyy"}}},computed:{windowOpt:function(){return{show:this.show,type:"custom",head:this.$t("design.designParamSelect"),style:{width:"480px",height:"300px"}}},dataPickerOpt:function(){var t,e={},a=Object(i.a)(this.showParamSetting);try{for(a.s();!(t=a.n()).done;){var n=t.value,o={eCont:n.key+"ParamSetting",isShowNavImg:!1,isShowWeek:"week"===n.unit,isShowQs:"quarterly"===n.unit,realDateFmt:this.dataFmt[n.unit],dateFmt:this.dataFmt[n.unit],alwaysUseStartDate:!0,disabledDates:"quarterly"===n.unit?["....0[5-9]","....1[0-2]"]:null,startDate:this.selectedValue[n.key].pickerDate,minDate:"endTime"===n.key?this.selectedValue.beginTime.pickerDate:"1900-01-01",maxDate:"beginTime"===n.key?this.selectedValue.endTime.pickerDate:"2099-12-31"};e[n.key]=o}}catch(t){a.e(t)}finally{a.f()}return e},selectedValue:function(){return t.extend(!0,{},this.paramValue,this.currentValue)}},methods:{ychanged:function(t,e){["yyyy","yyyy-MM"].includes(this.dataPickerOpt[e.key].dateFmt)&&this.selectValue(t,e)},selectParam:function(t){this.$emit("selectParam",t,this.currentValue)},selectValue:function(){var t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],a=t.cal.getP("y","yyyy"),i=t.cal.getP("M","MM"),n=t.cal.getP("d","dd"),o="",s="";switch(e.unit){case"year":o+=a,s+=a;break;case"quarterly":o=o+a+"-"+i,s=s+a+i;break;case"month":o=o+a+"-"+i,s+=this.dateFormat(e.timeFormat,e.unit,a,i,n);break;case"week":o=o+a+"-"+i+"-"+n,s=s+a+t.cal.getP("W","WW");break;case"day":o=o+a+"-"+i+"-"+n,s+=this.dateFormat(e.timeFormat,e.unit,a,i,n)}this.$set(this.currentValue,e.key,{pickerDate:o,realDate:s})},dateFormat:function(t,e,a,i,n){var o="";switch(t){case"YYYYMMDD":o=o+a+i,"day"===e&&(o+=n);break;case"YYYY-MM-DD":o=o+a+"-"+i,"day"===e&&(o=o+"-"+n);break;case"YYYY/MM/DD":o=o+a+"/"+i,"day"===e&&(o=o+"/"+n);break;case"MMDD,YYYY":o+=i,"day"===e&&(o+=n),o=o+","+a;break;case"MM-DD-YYYY":o+=i,"day"===e&&(o=o+"-"+n),o=o+"-"+a;break;case"MM/DD/YYYY":o+=i,"day"===e&&(o=o+"/"+n),o=o+"/"+a}return o}}}}).call(this,a("1157"))},fa14:function(t,e,a){},fa44:function(t,e,a){"use strict";var i=a("ea3d");a.n(i).a}}]);